# é€”ç‚¹å„¿å•¥é¡¹ç›®å…¬ç½‘éƒ¨ç½²æ£€æŸ¥æ¸…å•

**é¡¹ç›®åç§°**: é€”ç‚¹å„¿å•¥ - åä½œå¼æ—…è¡Œè§„åˆ’ç³»ç»Ÿ  
**éƒ¨ç½²æ—¥æœŸ**: 2025å¹´12æœˆ13æ—¥  
**éƒ¨ç½²å·¥ç¨‹å¸ˆ**: AI Assistant

---

## ğŸ“‹ ä¿¡æ¯æ”¶é›†æ¸…å•

### 1. æœåŠ¡å™¨ä¿¡æ¯

```yaml
æœåŠ¡å™¨é…ç½®:
  å…¬ç½‘IP: ________________
  äº‘æœåŠ¡å•†: [ ] é˜¿é‡Œäº‘ [ ] è…¾è®¯äº‘ [ ] åä¸ºäº‘ [ ] AWS [ ] å…¶ä»–: ________
  æ“ä½œç³»ç»Ÿ: [ ] Ubuntu 22.04 [ ] CentOS 7 [ ] å…¶ä»–: ________
  CPU: ___æ ¸
  å†…å­˜: ___GB
  ç£ç›˜: ___GB
  
SSHè¿æ¥ä¿¡æ¯:
  ç«¯å£: _______ (é»˜è®¤22)
  ç”¨æˆ·å: _________________
  ç™»å½•æ–¹å¼: [ ] å¯†ç  [ ] å¯†é’¥
  å¯†ç /å¯†é’¥è·¯å¾„: _________________
```

**æœ€ä½é…ç½®è¦æ±‚**ï¼š
- CPU: 2æ ¸
- å†…å­˜: 4GB
- ç£ç›˜: 40GB
- å¸¦å®½: 1Mbps

---

### 2. åŸŸåä¿¡æ¯

```yaml
åŸŸåé…ç½®:
  æ˜¯å¦æœ‰åŸŸå: [ ] æ˜¯ [ ] å¦
  åŸŸå: _________________
  DNSè§£æçŠ¶æ€: [ ] å·²è§£æ [ ] æœªè§£æ
  å¤‡æ¡ˆçŠ¶æ€: [ ] å·²å¤‡æ¡ˆ [ ] æœªå¤‡æ¡ˆ [ ] æ— éœ€å¤‡æ¡ˆï¼ˆæµ·å¤–æœåŠ¡å™¨ï¼‰
  
SSLè¯ä¹¦:
  æ˜¯å¦å¯ç”¨HTTPS: [ ] æ˜¯ [ ] å¦
  è¯ä¹¦ç±»å‹: [ ] Let's Encryptå…è´¹è¯ä¹¦ [ ] ä»˜è´¹è¯ä¹¦ [ ] æš‚ä¸ä½¿ç”¨
```

**åŸŸåè®¿é—®ç¤ºä¾‹**ï¼š
- æœ‰åŸŸå: `http://tudianersha.com` æˆ– `https://tudianersha.com`
- æ— åŸŸå: `http://123.456.789.012:8010`

---

### 3. æ•°æ®åº“é…ç½®

```yaml
æ•°æ®åº“æ–¹æ¡ˆ: [ ] äº‘æ•°æ®åº“RDS [ ] æœåŠ¡å™¨è‡ªå»ºMySQL [ ] ç°æœ‰æ•°æ®åº“

äº‘æ•°æ®åº“RDSé…ç½® (å¦‚é€‚ç”¨):
  æ•°æ®åº“åœ°å€: _________________
  ç«¯å£: _______ (é»˜è®¤3306)
  æ•°æ®åº“å: tudianersha
  ç”¨æˆ·å: _________________
  å¯†ç : _________________
  
æœåŠ¡å™¨è‡ªå»ºMySQLé…ç½® (å¦‚é€‚ç”¨):
  MySQLç‰ˆæœ¬: [ ] 8.0 [ ] 5.7
  rootå¯†ç : _________________
  åº”ç”¨æ•°æ®åº“å: tudianersha
  åº”ç”¨ç”¨æˆ·å: _________________
  åº”ç”¨ç”¨æˆ·å¯†ç : _________________
```

**æ•°æ®è¿ç§»**ï¼š
- [ ] éœ€è¦ä»æœ¬åœ°æ•°æ®åº“è¿ç§»æ•°æ®
- [ ] å…¨æ–°éƒ¨ç½²ï¼Œæ— éœ€è¿ç§»

---

### 4. ç¬¬ä¸‰æ–¹æœåŠ¡å¯†é’¥

```yaml
Kimi AI:
  å½“å‰å¯†é’¥: sk-bCclui8VTON2LeiUgmNSUwPiC6FxmyIwpkXvidii4m4NQoTI
  ç”Ÿäº§ç¯å¢ƒ: [ ] ç»§ç»­ä½¿ç”¨å½“å‰å¯†é’¥ [ ] æ›´æ¢æ–°å¯†é’¥: _________________
  
é«˜å¾·åœ°å›¾:
  å½“å‰å¯†é’¥: 4290f3a6e308a95a70bc29f5577a6a21
  ç”Ÿäº§ç¯å¢ƒ: [ ] ç»§ç»­ä½¿ç”¨å½“å‰å¯†é’¥ [ ] æ›´æ¢æ–°å¯†é’¥: _________________
  
QQé‚®ç®±SMTP:
  SMTPæœåŠ¡å™¨: smtp.qq.com
  é‚®ç®±åœ°å€: _________________
  SMTPæˆæƒç : _________________
  (æ³¨æ„: ä¸æ˜¯QQå¯†ç ï¼Œéœ€åœ¨QQé‚®ç®±è®¾ç½®ä¸­ç”Ÿæˆ)
```

**å¯†é’¥å®‰å…¨æç¤º**ï¼š
- âœ… ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ç‹¬ç«‹å¯†é’¥
- âœ… å®šæœŸæ›´æ¢å¯†é’¥
- âŒ ä¸è¦åœ¨å…¬å¼€ä»£ç ä¸­æš´éœ²å¯†é’¥

---

### 5. éƒ¨ç½²æ–¹å¼é€‰æ‹©

```yaml
éƒ¨ç½²æ–¹æ¡ˆ: 
  [ ] æ–¹æ¡ˆ1: ç®€å•éƒ¨ç½² (JARåŒ…ç›´æ¥è¿è¡Œ)
      - è®¿é—®æ–¹å¼: http://IP:8010
      - é€‚ç”¨åœºæ™¯: å¿«é€Ÿæµ‹è¯•
      
  [ ] æ–¹æ¡ˆ2: æ ‡å‡†éƒ¨ç½² (Nginxåå‘ä»£ç† + JAR)
      - è®¿é—®æ–¹å¼: http://åŸŸå æˆ– https://åŸŸå
      - é€‚ç”¨åœºæ™¯: æ­£å¼ä¸Šçº¿
      
  [ ] æ–¹æ¡ˆ3: å®Œæ•´æ–¹æ¡ˆ (Nginx + Docker + MySQL)
      - è®¿é—®æ–¹å¼: https://åŸŸå
      - é€‚ç”¨åœºæ™¯: ç”Ÿäº§ç¯å¢ƒ
```

**æ¨è**ï¼šæ–¹æ¡ˆ2ï¼ˆæ ‡å‡†éƒ¨ç½²ï¼‰

---

### 6. ç«¯å£ä¸å®‰å…¨é…ç½®

```yaml
é˜²ç«å¢™/å®‰å…¨ç»„è§„åˆ™:
  éœ€è¦å¼€æ”¾çš„ç«¯å£:
    - 80   (HTTP)   [ ] å·²å¼€æ”¾ [ ] å¾…å¼€æ”¾
    - 443  (HTTPS)  [ ] å·²å¼€æ”¾ [ ] å¾…å¼€æ”¾
    - 22   (SSH)    [ ] å·²å¼€æ”¾ [ ] å¾…å¼€æ”¾
    
  ç¦æ­¢å…¬ç½‘è®¿é—®çš„ç«¯å£:
    - 3306 (MySQL)  [ ] å·²é™åˆ¶ [ ] å¾…é™åˆ¶
    - 8010 (Spring Boot) [ ] å·²é™åˆ¶ [ ] å¾…é™åˆ¶

SSHå®‰å…¨åŠ å›º:
  [ ] ç¦ç”¨rootå¯†ç ç™»å½•
  [ ] ä»…å…è®¸å¯†é’¥ç™»å½•
  [ ] é™åˆ¶SSHè®¿é—®IPç™½åå•
```

---

## ğŸš€ è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹

### é˜¶æ®µ1: ç¯å¢ƒå‡†å¤‡ (è‡ªåŠ¨åŒ–æ‰§è¡Œ)

```bash
# 1.1 è¿æ¥æœåŠ¡å™¨
ssh -p <ç«¯å£> <ç”¨æˆ·å>@<æœåŠ¡å™¨IP>

# 1.2 æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y  # Ubuntu
# æˆ–
sudo yum update -y  # CentOS

# 1.3 å®‰è£…Java 17
sudo apt install openjdk-17-jdk -y  # Ubuntu
# æˆ–
sudo yum install java-17-openjdk -y  # CentOS

# éªŒè¯å®‰è£…
java -version

# 1.4 å®‰è£…MySQL (å¦‚æœé€‰æ‹©æœåŠ¡å™¨è‡ªå»º)
sudo apt install mysql-server -y  # Ubuntu
# æˆ–
sudo yum install mysql-server -y  # CentOS

# å¯åŠ¨MySQL
sudo systemctl start mysql
sudo systemctl enable mysql

# 1.5 å®‰è£…Nginx (å¦‚æœé€‰æ‹©æ ‡å‡†éƒ¨ç½²)
sudo apt install nginx -y  # Ubuntu
# æˆ–
sudo yum install nginx -y  # CentOS

# å¯åŠ¨Nginx
sudo systemctl start nginx
sudo systemctl enable nginx
```

**æ‰§è¡ŒçŠ¶æ€**ï¼š
- [ ] Java 17 å®‰è£…å®Œæˆ
- [ ] MySQL å®‰è£…å®Œæˆ
- [ ] Nginx å®‰è£…å®Œæˆ

---

### é˜¶æ®µ2: æ•°æ®åº“åˆå§‹åŒ– (è‡ªåŠ¨åŒ–æ‰§è¡Œ)

```bash
# 2.1 ç™»å½•MySQL
sudo mysql -u root -p

# 2.2 åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
CREATE DATABASE tudianersha DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'tudianersha_user'@'localhost' IDENTIFIED BY '<è®¾ç½®å¯†ç >';
GRANT ALL PRIVILEGES ON tudianersha.* TO 'tudianersha_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;

# 2.3 å¯¼å…¥æ•°æ®åº“ç»“æ„
mysql -u tudianersha_user -p tudianersha < /path/to/schema.sql
```

**æ‰§è¡ŒçŠ¶æ€**ï¼š
- [ ] æ•°æ®åº“åˆ›å»ºå®Œæˆ
- [ ] ç”¨æˆ·æƒé™é…ç½®å®Œæˆ
- [ ] è¡¨ç»“æ„å¯¼å…¥å®Œæˆ

---

### é˜¶æ®µ3: åº”ç”¨éƒ¨ç½² (è‡ªåŠ¨åŒ–æ‰§è¡Œ)

```bash
# 3.1 åˆ›å»ºåº”ç”¨ç›®å½•
sudo mkdir -p /opt/tudianersha
sudo chown -R <ç”¨æˆ·å>:<ç”¨æˆ·ç»„> /opt/tudianersha

# 3.2 ä¸Šä¼ JARåŒ…
# æœ¬åœ°æ‰§è¡Œæ‰“åŒ…
cd e:/tudianershatest/tudianersha
mvn clean package -DskipTests

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp -P <ç«¯å£> target/tudianersha-1.0.0.jar <ç”¨æˆ·å>@<æœåŠ¡å™¨IP>:/opt/tudianersha/

# 3.3 ä¸Šä¼ é…ç½®æ–‡ä»¶
scp -P <ç«¯å£> application-prod.yml <ç”¨æˆ·å>@<æœåŠ¡å™¨IP>:/opt/tudianersha/

# 3.4 åˆ›å»ºå¯åŠ¨è„šæœ¬
cat > /opt/tudianersha/start.sh << 'EOF'
#!/bin/bash
nohup java -jar \
  -Dspring.profiles.active=prod \
  -Xms512m -Xmx1024m \
  /opt/tudianersha/tudianersha-1.0.0.jar \
  > /opt/tudianersha/app.log 2>&1 &
echo $! > /opt/tudianersha/app.pid
EOF

chmod +x /opt/tudianersha/start.sh

# 3.5 åˆ›å»ºåœæ­¢è„šæœ¬
cat > /opt/tudianersha/stop.sh << 'EOF'
#!/bin/bash
if [ -f /opt/tudianersha/app.pid ]; then
  kill $(cat /opt/tudianersha/app.pid)
  rm /opt/tudianersha/app.pid
fi
EOF

chmod +x /opt/tudianersha/stop.sh
```

**æ‰§è¡ŒçŠ¶æ€**ï¼š
- [ ] JARåŒ…ä¸Šä¼ å®Œæˆ
- [ ] é…ç½®æ–‡ä»¶é…ç½®å®Œæˆ
- [ ] å¯åŠ¨è„šæœ¬åˆ›å»ºå®Œæˆ

---

### é˜¶æ®µ4: Nginxé…ç½® (å¦‚æœé€‰æ‹©æ ‡å‡†éƒ¨ç½²)

```nginx
# 4.1 åˆ›å»ºNginxé…ç½®æ–‡ä»¶
sudo nano /etc/nginx/sites-available/tudianersha

# é…ç½®å†…å®¹
server {
    listen 80;
    server_name <åŸŸåæˆ–IP>;

    # è®¿é—®æ—¥å¿—
    access_log /var/log/nginx/tudianersha_access.log;
    error_log /var/log/nginx/tudianersha_error.log;

    # é™æ€èµ„æº
    location /css/ {
        proxy_pass http://localhost:8010/css/;
    }
    
    location /js/ {
        proxy_pass http://localhost:8010/js/;
    }

    # APIæ¥å£
    location /api/ {
        proxy_pass http://localhost:8010/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # å…¶ä»–è¯·æ±‚
    location / {
        proxy_pass http://localhost:8010/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}

# 4.2 å¯ç”¨é…ç½®
sudo ln -s /etc/nginx/sites-available/tudianersha /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

**HTTPSé…ç½® (å¯é€‰)**ï¼š
```bash
# å®‰è£…Certbot
sudo apt install certbot python3-certbot-nginx -y

# è‡ªåŠ¨ç”³è¯·å¹¶é…ç½®SSLè¯ä¹¦
sudo certbot --nginx -d <åŸŸå>

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

**æ‰§è¡ŒçŠ¶æ€**ï¼š
- [ ] Nginxé…ç½®å®Œæˆ
- [ ] SSLè¯ä¹¦é…ç½®å®Œæˆ

---

### é˜¶æ®µ5: ç³»ç»ŸæœåŠ¡é…ç½® (æ¨è)

```bash
# 5.1 åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶
sudo nano /etc/systemd/system/tudianersha.service

# æœåŠ¡é…ç½®
[Unit]
Description=Tudianersha Travel Planning System
After=network.target mysql.service

[Service]
Type=forking
User=<ç”¨æˆ·å>
WorkingDirectory=/opt/tudianersha
ExecStart=/opt/tudianersha/start.sh
ExecStop=/opt/tudianersha/stop.sh
Restart=on-failure
RestartSec=10

[Install]
WantedBy=multi-user.target

# 5.2 å¯ç”¨æœåŠ¡
sudo systemctl daemon-reload
sudo systemctl enable tudianersha
sudo systemctl start tudianersha

# 5.3 æŸ¥çœ‹çŠ¶æ€
sudo systemctl status tudianersha
```

**æ‰§è¡ŒçŠ¶æ€**ï¼š
- [ ] ç³»ç»ŸæœåŠ¡åˆ›å»ºå®Œæˆ
- [ ] åº”ç”¨å¯åŠ¨æˆåŠŸ

---

## âœ… éƒ¨ç½²éªŒè¯æ¸…å•

### 1. åº”ç”¨è®¿é—®éªŒè¯

```bash
# æ£€æŸ¥Javaè¿›ç¨‹
ps aux | grep tudianersha

# æ£€æŸ¥ç«¯å£ç›‘å¬
sudo netstat -tlnp | grep 8010

# æ£€æŸ¥åº”ç”¨æ—¥å¿—
tail -f /opt/tudianersha/app.log
```

**æµè§ˆå™¨è®¿é—®æµ‹è¯•**ï¼š
- [ ] HTTPè®¿é—®: http://<åŸŸåæˆ–IP>
- [ ] HTTPSè®¿é—®: https://<åŸŸå> (å¦‚æœé…ç½®)
- [ ] ç™»å½•é¡µé¢: http://<åŸŸåæˆ–IP>/login.html
- [ ] APIæ¥å£: http://<åŸŸåæˆ–IP>/api/health

---

### 2. åŠŸèƒ½æµ‹è¯•

```
ç”¨æˆ·æ³¨å†Œ: [ ] é€šè¿‡ [ ] å¤±è´¥
ç”¨æˆ·ç™»å½•: [ ] é€šè¿‡ [ ] å¤±è´¥
åˆ›å»ºé¡¹ç›®: [ ] é€šè¿‡ [ ] å¤±è´¥
AIè·¯çº¿ç”Ÿæˆ: [ ] é€šè¿‡ [ ] å¤±è´¥
å®æ—¶èŠå¤©: [ ] é€šè¿‡ [ ] å¤±è´¥
PDFå¯¼å‡º: [ ] é€šè¿‡ [ ] å¤±è´¥
```

---

### 3. æ€§èƒ½æµ‹è¯•

```bash
# å†…å­˜ä½¿ç”¨
free -h

# ç£ç›˜ä½¿ç”¨
df -h

# CPUä½¿ç”¨
top

# åº”ç”¨å†…å­˜å ç”¨
ps aux | grep tudianersha
```

**æ€§èƒ½æŒ‡æ ‡**ï¼š
- åº”ç”¨å†…å­˜å ç”¨: _______ MB
- CPUä½¿ç”¨ç‡: _______ %
- å“åº”æ—¶é—´: _______ ms

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. åº”ç”¨æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥Javaç‰ˆæœ¬
java -version

# æ£€æŸ¥ç«¯å£å ç”¨
sudo lsof -i :8010

# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
cat /opt/tudianersha/app.log
```

#### 2. æ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
mysql -h <æ•°æ®åº“åœ°å€> -u <ç”¨æˆ·å> -p

# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status
```

#### 3. Nginx 502é”™è¯¯
```bash
# æ£€æŸ¥Spring Bootæ˜¯å¦è¿è¡Œ
ps aux | grep tudianersha

# æ£€æŸ¥Nginxé…ç½®
sudo nginx -t

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

---

## ğŸ“Š ç›‘æ§ä¸ç»´æŠ¤

### æ—¥å¿—ç®¡ç†

```bash
# åº”ç”¨æ—¥å¿—
tail -f /opt/tudianersha/app.log

# Nginxè®¿é—®æ—¥å¿—
tail -f /var/log/nginx/tudianersha_access.log

# Nginxé”™è¯¯æ—¥å¿—
tail -f /var/log/nginx/tudianersha_error.log

# ç³»ç»Ÿæ—¥å¿—
sudo journalctl -u tudianersha -f
```

### å¤‡ä»½ç­–ç•¥

```bash
# æ•°æ®åº“å¤‡ä»½
mysqldump -u tudianersha_user -p tudianersha > backup_$(date +%Y%m%d).sql

# åº”ç”¨å¤‡ä»½
tar -czf tudianersha_backup_$(date +%Y%m%d).tar.gz /opt/tudianersha
```

**å»ºè®®**ï¼š
- [ ] æ¯å¤©è‡ªåŠ¨å¤‡ä»½æ•°æ®åº“
- [ ] æ¯å‘¨å¤‡ä»½åº”ç”¨æ–‡ä»¶
- [ ] å¤‡ä»½æ–‡ä»¶ä¿ç•™30å¤©

---

## ğŸ“ è”ç³»ä¿¡æ¯

**éƒ¨ç½²æ”¯æŒ**: AI Assistant  
**ç´§æ€¥è”ç³»**: æä¾›é¡¹ç›®ç›¸å…³ä¿¡æ¯åè·å–æ”¯æŒ

---

## ğŸ“ éƒ¨ç½²è®°å½•

| æ—¥æœŸ | æ“ä½œ | æ‰§è¡Œäºº | å¤‡æ³¨ |
|------|------|--------|------|
| 2025-12-13 | åˆ›å»ºéƒ¨ç½²æ¸…å• | AI Assistant | åˆå§‹ç‰ˆæœ¬ |
|  |  |  |  |
|  |  |  |  |

---

**çŠ¶æ€**: [ ] å¾…éƒ¨ç½² [ ] éƒ¨ç½²ä¸­ [ ] å·²å®Œæˆ [ ] å·²ä¸Šçº¿

**æœ€åæ›´æ–°**: 2025å¹´12æœˆ13æ—¥
