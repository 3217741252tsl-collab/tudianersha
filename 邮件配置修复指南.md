# é‚®ä»¶æœåŠ¡é…ç½®ä¿®å¤æŒ‡å—

**é”™è¯¯æ—¶é—´**: 2025å¹´12æœˆ13æ—¥ 14:48  
**é”™è¯¯ç±»å‹**: Beanæ³¨å…¥å¤±è´¥ - JavaMailSender  
**å½±å“åŠŸèƒ½**: ç”¨æˆ·æ³¨å†Œé‚®ä»¶éªŒè¯ç 

---

## âŒ é”™è¯¯è¯¦æƒ…

### å®Œæ•´é”™è¯¯ä¿¡æ¯

```
***************************
APPLICATION FAILED TO START
***************************

Description:

Field mailSender in com.tudianersha.service.EmailService required a bean of type 
'org.springframework.mail.javamail.JavaMailSender' that could not be found.

The injection point has the following annotations:
	- @org.springframework.beans.factory.annotation.Autowired(required=true)

Action:

Consider defining a bean of type 'org.springframework.mail.javamail.JavaMailSender' 
in your configuration.
```

### é”™è¯¯åŸå› 

**æ ¹æœ¬åŸå› **: `application.yml` ä¸­ç¼ºå°‘é‚®ä»¶æœåŠ¡é…ç½®

**ä¾èµ–å…³ç³»**:
```
EmailService.java
    â†“ @Autowired
JavaMailSender (Spring Bean)
    â†“ éœ€è¦é…ç½®
spring.mail.* (application.yml)  â† ç¼ºå¤±ï¼
```

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### å·²æ·»åŠ çš„é…ç½®

**æ–‡ä»¶**: `tudianersha/src/main/resources/application.yml`  
**ä½ç½®**: ç¬¬17-33è¡Œ

```yaml
spring:
  # ... å…¶ä»–é…ç½® ...
  
  # Mail Configuration
  mail:
    host: smtp.qq.com
    port: 587
    username: your-email@qq.com
    password: your-smtp-authorization-code
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
    default-encoding: UTF-8
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### é‚®ä»¶æœåŠ¡å™¨å‚æ•°

| é…ç½®é¡¹ | å€¼ | è¯´æ˜ |
|--------|---|------|
| `host` | smtp.qq.com | QQé‚®ç®±SMTPæœåŠ¡å™¨åœ°å€ |
| `port` | 587 | SMTPç«¯å£ï¼ˆTLSåŠ å¯†ï¼‰ |
| `username` | your-email@qq.com | **éœ€è¦æ›¿æ¢ä¸ºæ‚¨çš„QQé‚®ç®±** |
| `password` | your-smtp-authorization-code | **éœ€è¦æ›¿æ¢ä¸ºSMTPæˆæƒç ** |
| `auth` | true | å¯ç”¨SMTPè®¤è¯ |
| `starttls.enable` | true | å¯ç”¨TLSåŠ å¯† |
| `default-encoding` | UTF-8 | é‚®ä»¶ç¼–ç æ ¼å¼ |

---

## ğŸ”§ ä¸¤ç§å¯åŠ¨æ–¹å¼

### æ–¹å¼1: ä¸´æ—¶å¯åŠ¨ï¼ˆä¸é…ç½®çœŸå®é‚®ç®±ï¼‰â­ æ¨è

**é€‚ç”¨åœºæ™¯**: 
- å¿«é€Ÿæµ‹è¯•å…¶ä»–åŠŸèƒ½
- æš‚æ—¶ä¸ä½¿ç”¨é‚®ä»¶éªŒè¯ç åŠŸèƒ½

**æ“ä½œ**: **æ— éœ€ä¿®æ”¹é…ç½®ï¼Œç›´æ¥å¯åŠ¨å³å¯**

**è¯´æ˜**:
- è™½ç„¶é…ç½®æ˜¯å ä½ç¬¦ï¼Œä½†Spring Bootä¼šåˆ›å»ºJavaMailSender Bean
- åº”ç”¨å¯ä»¥æ­£å¸¸å¯åŠ¨
- **å…¶ä»–åŠŸèƒ½ï¼ˆAIè·¯çº¿ç”Ÿæˆã€åä½œç­‰ï¼‰ä¸å—å½±å“**
- åªæœ‰å‘é€é‚®ä»¶æ—¶ä¼šæŠ¥é”™ï¼ˆä¸å½±å“å¯åŠ¨ï¼‰

**éªŒè¯**:
```
[INFO] Tomcat started on port(s): 8010 (http)
[INFO] Started Application in X.XXX seconds
```

---

### æ–¹å¼2: å®Œæ•´é…ç½®ï¼ˆå¯ç”¨é‚®ä»¶åŠŸèƒ½ï¼‰

**é€‚ç”¨åœºæ™¯**:
- éœ€è¦æµ‹è¯•ç”¨æˆ·æ³¨å†Œé‚®ä»¶éªŒè¯ç åŠŸèƒ½
- æ­£å¼éƒ¨ç½²å‰çš„å®Œæ•´æµ‹è¯•

**æ­¥éª¤**:

#### æ­¥éª¤1: è·å–QQé‚®ç®±SMTPæˆæƒç 

**æ“ä½œæŒ‡å—**:

1. **ç™»å½•QQé‚®ç®±**
   - è®¿é—®: https://mail.qq.com
   - ä½¿ç”¨æ‚¨çš„QQè´¦å·ç™»å½•

2. **è¿›å…¥è®¾ç½®**
   - ç‚¹å‡»é¡¶éƒ¨"è®¾ç½®"
   - é€‰æ‹©"è´¦æˆ·"æ ‡ç­¾

3. **å¼€å¯SMTPæœåŠ¡**
   - æ‰¾åˆ°"POP3/IMAP/SMTP/Exchange/CardDAV/CalDAVæœåŠ¡"
   - å¼€å¯"SMTPæœåŠ¡"ï¼ˆå¦‚æœæœªå¼€å¯ï¼‰

4. **ç”Ÿæˆæˆæƒç **
   - ç‚¹å‡»"ç”Ÿæˆæˆæƒç "
   - æ ¹æ®æç¤ºå‘é€çŸ­ä¿¡éªŒè¯
   - **å¤åˆ¶ç”Ÿæˆçš„æˆæƒç **ï¼ˆ16ä½å­—ç¬¦ï¼‰

**æˆªå›¾åˆ¶ä½œ**:
- æˆªå–"ç”Ÿæˆæˆæƒç "æˆåŠŸé¡µé¢
- ç¡®ä¿æˆæƒç å¯è§ï¼ˆå»ºè®®é©¬ä¸Šå¤åˆ¶ä¿å­˜ï¼‰

**ç¤ºä¾‹æˆæƒç æ ¼å¼**:
```
abcdefghijklmnop  (16ä½å­—æ¯)
```

---

#### æ­¥éª¤2: ä¿®æ”¹application.yml

**æ–‡ä»¶è·¯å¾„**: `tudianersha/src/main/resources/application.yml`

**ä¿®æ”¹å†…å®¹**:

```yaml
spring:
  mail:
    host: smtp.qq.com
    port: 587
    username: 1234567890@qq.com          # â† æ›¿æ¢ä¸ºæ‚¨çš„QQé‚®ç®±
    password: abcdefghijklmnop           # â† æ›¿æ¢ä¸ºæ‚¨çš„SMTPæˆæƒç 
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
    default-encoding: UTF-8
```

**âš ï¸ æ³¨æ„äº‹é¡¹**:
- `username`: å®Œæ•´çš„QQé‚®ç®±åœ°å€ï¼ˆå¦‚ 1234567890@qq.comï¼‰
- `password`: **SMTPæˆæƒç **ï¼Œä¸æ˜¯QQå¯†ç ï¼
- æˆæƒç æ˜¯16ä½å­—æ¯ï¼Œæ— ç©ºæ ¼

---

#### æ­¥éª¤3: é‡å¯åº”ç”¨

**IDEAæ“ä½œ**:
1. åœæ­¢å½“å‰è¿è¡Œçš„åº”ç”¨ï¼ˆç‚¹å‡»çº¢è‰²æ–¹å— â¬›ï¼‰
2. å³é”® `Application.java` â†’ Run 'Application.main()'
3. è§‚å¯Ÿå¯åŠ¨æ—¥å¿—

**é¢„æœŸæ—¥å¿—**:
```
[INFO] Started Application in X.XXX seconds
```

---

## âœ… å¯åŠ¨éªŒè¯

### éªŒè¯1: åº”ç”¨å¯åŠ¨æˆåŠŸ

**æ£€æŸ¥æ—¥å¿—**:
```
[INFO] Tomcat started on port(s): 8010 (http)
[INFO] Started Application in X.XXX seconds
```

**æˆªå›¾åˆ¶ä½œ**:
- æˆªå–IDEAåº•éƒ¨"Run"çª—å£
- ç¡®ä¿åŒ…å«ä¸Šè¿°æˆåŠŸæ—¥å¿—

---

### éªŒè¯2: é‚®ä»¶åŠŸèƒ½æµ‹è¯•ï¼ˆå¦‚æœé…ç½®äº†çœŸå®é‚®ç®±ï¼‰

**æµ‹è¯•æ­¥éª¤**:

1. **æ‰“å¼€æ³¨å†Œé¡µé¢**
   ```
   http://localhost:8010/login.html
   ```
   ç‚¹å‡»"æ³¨å†Œ"

2. **å¡«å†™æ³¨å†Œä¿¡æ¯**
   - ç”¨æˆ·å: testuser
   - é‚®ç®±: your-test-email@qq.comï¼ˆæ‚¨çš„å¦ä¸€ä¸ªé‚®ç®±ï¼‰
   - å¯†ç : Test@123

3. **ç‚¹å‡»"å‘é€éªŒè¯ç "**

4. **æ£€æŸ¥é‚®ç®±**
   - ç™»å½•æ¥æ”¶é‚®ç®±
   - æŸ¥çœ‹æ˜¯å¦æ”¶åˆ°éªŒè¯ç é‚®ä»¶

**é¢„æœŸç»“æœ**:
- âœ… æ”¶åˆ°é‚®ä»¶ï¼Œä¸»é¢˜: "é€”ç‚¹å„¿å•¥ - é‚®ç®±éªŒè¯ç "
- âœ… é‚®ä»¶å†…å®¹åŒ…å«6ä½æ•°å­—éªŒè¯ç 

**æˆªå›¾åˆ¶ä½œ**:
- æˆªå–æ”¶åˆ°çš„é‚®ä»¶å†…å®¹
- ç¡®ä¿æ˜¾ç¤ºéªŒè¯ç 

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜1: åº”ç”¨ä»æ— æ³•å¯åŠ¨

**é”™è¯¯ä¿¡æ¯**:
```
Field mailSender in com.tudianersha.service.EmailService required a bean...
```

**å¯èƒ½åŸå› **: é…ç½®æ–‡ä»¶ç¼©è¿›é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:

æ£€æŸ¥ `application.yml` ç¼©è¿›æ˜¯å¦æ­£ç¡®ï¼š

```yaml
spring:              # é¡¶æ ¼
  datasource:        # 2ä¸ªç©ºæ ¼
    url: ...         # 4ä¸ªç©ºæ ¼
  jpa:               # 2ä¸ªç©ºæ ¼
    hibernate:       # 4ä¸ªç©ºæ ¼
  mail:              # 2ä¸ªç©ºæ ¼ â† å¿…é¡»å¯¹é½datasourceã€jpa
    host: ...        # 4ä¸ªç©ºæ ¼
    port: 587        # 4ä¸ªç©ºæ ¼
```

**âš ï¸ YAMLæ ¼å¼è¦æ±‚**:
- ä½¿ç”¨**ç©ºæ ¼**ç¼©è¿›ï¼Œä¸èƒ½ç”¨Tab
- åŒçº§é…ç½®å¿…é¡»å¯¹é½
- å†’å·åå¿…é¡»æœ‰ç©ºæ ¼

---

### é—®é¢˜2: å‘é€é‚®ä»¶å¤±è´¥

**é”™è¯¯ä¿¡æ¯**:
```
AuthenticationFailedException: 535 Login Fail
```

**å¯èƒ½åŸå› **:
1. SMTPæˆæƒç é”™è¯¯
2. æœªå¼€å¯SMTPæœåŠ¡
3. ä½¿ç”¨äº†QQå¯†ç è€Œéæˆæƒç 

**è§£å†³æ–¹æ¡ˆ**:

1. **é‡æ–°ç”Ÿæˆæˆæƒç **
   - ç™»å½•QQé‚®ç®±
   - è®¾ç½® â†’ è´¦æˆ·
   - å…³é—­SMTPæœåŠ¡ï¼Œå†é‡æ–°å¼€å¯
   - é‡æ–°ç”Ÿæˆæˆæƒç 

2. **éªŒè¯é…ç½®**
   ```yaml
   username: æ­£ç¡®çš„QQé‚®ç®±
   password: æ­£ç¡®çš„16ä½æˆæƒç ï¼ˆä¸æ˜¯QQå¯†ç ï¼‰
   ```

3. **æ£€æŸ¥æ—¥å¿—**
   ```
   tail -f logs/application.log
   # æˆ–åœ¨IDEAçš„Runçª—å£æŸ¥çœ‹è¯¦ç»†é”™è¯¯
   ```

---

### é—®é¢˜3: é‚®ä»¶å‘é€æ…¢æˆ–è¶…æ—¶

**é”™è¯¯ä¿¡æ¯**:
```
MessagingException: Connection timeout
```

**å¯èƒ½åŸå› **:
1. ç½‘ç»œé—®é¢˜
2. QQé‚®ç®±æœåŠ¡å™¨é™æµ
3. ç«¯å£è¢«é˜²ç«å¢™é˜»æ­¢

**è§£å†³æ–¹æ¡ˆ**:

1. **ä¿®æ”¹è¶…æ—¶é…ç½®**

```yaml
spring:
  mail:
    # ... å…¶ä»–é…ç½® ...
    properties:
      mail:
        smtp:
          timeout: 10000           # 10ç§’è¶…æ—¶
          connectiontimeout: 10000 # è¿æ¥è¶…æ—¶
```

2. **æ£€æŸ¥é˜²ç«å¢™**
   ```powershell
   # æµ‹è¯•587ç«¯å£
   Test-NetConnection -ComputerName smtp.qq.com -Port 587
   ```

**é¢„æœŸç»“æœ**:
```
TcpTestSucceeded : True
```

---

## ğŸ“Š é…ç½®å¯¹æ¯”è¡¨

### å¼€å‘ç¯å¢ƒ vs ç”Ÿäº§ç¯å¢ƒ

| é…ç½®é¡¹ | å¼€å‘ç¯å¢ƒï¼ˆæœ¬åœ°ï¼‰ | ç”Ÿäº§ç¯å¢ƒï¼ˆæœåŠ¡å™¨ï¼‰ |
|--------|-----------------|-------------------|
| **é‚®ç®±åœ°å€** | æµ‹è¯•é‚®ç®±ï¼ˆå¦‚ä¸ªäººQQé‚®ç®±ï¼‰ | ä¼ä¸šé‚®ç®±æˆ–ä¸“ç”¨é‚®ç®± |
| **SMTPæœåŠ¡å™¨** | smtp.qq.com | ä¼ä¸šé‚®ç®±SMTPæœåŠ¡å™¨ |
| **ç”¨é€”** | æµ‹è¯•éªŒè¯ç åŠŸèƒ½ | æ­£å¼å‘é€ç”¨æˆ·é‚®ä»¶ |
| **å‘é€é¢‘ç‡** | éšæ„ | éœ€éµå®ˆé‚®ç®±æœåŠ¡å•†é™åˆ¶ |

### QQé‚®ç®± vs å…¶ä»–é‚®ç®±

| é‚®ç®±ç±»å‹ | SMTPæœåŠ¡å™¨ | ç«¯å£ | æˆæƒæ–¹å¼ |
|---------|-----------|------|---------|
| **QQé‚®ç®±** | smtp.qq.com | 587/465 | SMTPæˆæƒç  |
| **163é‚®ç®±** | smtp.163.com | 465 | å®¢æˆ·ç«¯æˆæƒå¯†ç  |
| **Gmail** | smtp.gmail.com | 587 | åº”ç”¨ä¸“ç”¨å¯†ç  |
| **ä¼ä¸šé‚®ç®±** | ä¼ä¸šSMTPæœåŠ¡å™¨ | è‡ªå®šä¹‰ | é‚®ç®±å¯†ç æˆ–æˆæƒç  |

---

## ğŸ¯ å¿«é€Ÿå¯åŠ¨æµç¨‹

### æœ€å¿«å¯åŠ¨æ–¹å¼ï¼ˆæ¨èï¼‰

**ç›´æ¥å¯åŠ¨ï¼Œæ— éœ€ä¿®æ”¹é…ç½®**ï¼š

1. **åœ¨IDEAä¸­å¯åŠ¨**
   ```
   å³é”® Application.java â†’ Run 'Application.main()'
   ```

2. **ç­‰å¾…å¯åŠ¨æˆåŠŸ**
   ```
   [INFO] Started Application in X.XXX seconds
   ```

3. **å¼€å§‹æµ‹è¯•å…¶ä»–åŠŸèƒ½**
   - ç™»å½•é¡µé¢: http://localhost:8010/login.html
   - AIè·¯çº¿ç”Ÿæˆ: æ­£å¸¸å¯ç”¨
   - åä½œåŠŸèƒ½: æ­£å¸¸å¯ç”¨
   - PDFå¯¼å‡º: æ­£å¸¸å¯ç”¨

**é™åˆ¶**:
- âŒ æ— æ³•æµ‹è¯•é‚®ä»¶éªŒè¯ç åŠŸèƒ½
- âœ… å…¶ä»–æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

---

### å®Œæ•´åŠŸèƒ½å¯åŠ¨æ–¹å¼

**éœ€è¦é‚®ä»¶åŠŸèƒ½æ—¶**ï¼š

1. **è·å–QQé‚®ç®±SMTPæˆæƒç **ï¼ˆ5åˆ†é’Ÿï¼‰
   - ç™»å½• https://mail.qq.com
   - è®¾ç½® â†’ è´¦æˆ· â†’ å¼€å¯SMTP â†’ ç”Ÿæˆæˆæƒç 

2. **ä¿®æ”¹application.yml**ï¼ˆ1åˆ†é’Ÿï¼‰
   ```yaml
   spring:
     mail:
       username: your-email@qq.com
       password: your-smtp-code
   ```

3. **é‡å¯åº”ç”¨**ï¼ˆ30ç§’ï¼‰
   ```
   åœæ­¢ â†’ é‡æ–°è¿è¡Œ
   ```

4. **æµ‹è¯•é‚®ä»¶åŠŸèƒ½**
   - æ³¨å†Œé¡µé¢ â†’ å‘é€éªŒè¯ç  â†’ æ£€æŸ¥é‚®ç®±

---

## ğŸ“ é…ç½®æ¨¡æ¿

### å®Œæ•´çš„application.ymlæ¨¡æ¿

```yaml
server:
  port: 8010

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/tudianersha?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=GMT%2B8
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver
  
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    database-platform: org.hibernate.dialect.MySQL8Dialect

  sql:
    init:
      mode: never

  # Mail Configuration
  mail:
    host: smtp.qq.com
    port: 587
    username: your-email@qq.com          # â† ä¿®æ”¹è¿™é‡Œ
    password: your-smtp-authorization-code # â† ä¿®æ”¹è¿™é‡Œ
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
    default-encoding: UTF-8

mybatis:
  mapper-locations: classpath:mapper/*.xml
  type-aliases-package: com.tudianersha.entity

logging:
  level:
    com.tudianersha: debug

# Kimi AI Configuration
kimi:
  api:
    key: sk-bCclui8VTON2LeiUgmNSUwPiC6FxmyIwpkXvidii4m4NQoTI
    url: https://api.moonshot.cn/v1/chat/completions
    model: moonshot-v1-8k
```

---

## â±ï¸ ä¸‹ä¸€æ­¥æ“ä½œ

### ç«‹å³æ‰§è¡Œ

1. **åœ¨IDEAä¸­é‡æ–°å¯åŠ¨åº”ç”¨**
   ```
   å³é”® Application.java â†’ Run 'Application.main()'
   ```

2. **è§‚å¯Ÿå¯åŠ¨æ—¥å¿—**
   - ç­‰å¾… "Started Application" å‡ºç°
   - ç¡®è®¤æ— ERRORæ—¥å¿—

3. **è®¿é—®ç™»å½•é¡µé¢**
   ```
   http://localhost:8010/login.html
   ```

**é¢„æœŸ**: åº”ç”¨æ­£å¸¸å¯åŠ¨ï¼Œé¡µé¢å¯è®¿é—® âœ…

---

### åç»­æµ‹è¯•ï¼ˆå¯é€‰ï¼‰

**å¦‚æœéœ€è¦æµ‹è¯•é‚®ä»¶åŠŸèƒ½**ï¼š
1. é…ç½®çœŸå®çš„QQé‚®ç®±SMTPæˆæƒç 
2. é‡å¯åº”ç”¨
3. æµ‹è¯•æ³¨å†Œé‚®ä»¶éªŒè¯ç 

**å¦‚æœæš‚ä¸éœ€è¦é‚®ä»¶åŠŸèƒ½**ï¼š
- ç›´æ¥å¼€å§‹æµ‹è¯•å…¶ä»–åŠŸèƒ½
- é‚®ä»¶åŠŸèƒ½ä»¥åå†é…ç½®

---

## ğŸ“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆéœ€è¦SMTPæˆæƒç ï¼Ÿ

**A**: QQé‚®ç®±ä¸ºäº†å®‰å…¨ï¼Œä¸å…è®¸ä½¿ç”¨QQå¯†ç ç›´æ¥ç™»å½•SMTPæœåŠ¡å™¨ã€‚å¿…é¡»ç”Ÿæˆä¸“ç”¨çš„æˆæƒç ã€‚

### Q2: æˆæƒç ä¸¢å¤±äº†æ€ä¹ˆåŠï¼Ÿ

**A**: é‡æ–°ç”Ÿæˆå³å¯ï¼Œæ—§çš„æˆæƒç ä¼šå¤±æ•ˆã€‚

### Q3: å¯ä»¥ç”¨å…¶ä»–é‚®ç®±å—ï¼Ÿ

**A**: å¯ä»¥ã€‚ä¿®æ”¹SMTPæœåŠ¡å™¨åœ°å€å’Œç«¯å£å³å¯ã€‚å¦‚163é‚®ç®±ã€Gmailç­‰ã€‚

### Q4: ä¸é…ç½®é‚®ç®±èƒ½å¯åŠ¨å—ï¼Ÿ

**A**: èƒ½ï¼ç°åœ¨çš„é…ç½®å·²ç»è¶³å¤Ÿè®©åº”ç”¨å¯åŠ¨ã€‚åªæ˜¯æ— æ³•å‘é€é‚®ä»¶ã€‚

---

**ä¿®å¤å®Œæˆ**: âœ…  
**åº”ç”¨çŠ¶æ€**: å¯ä»¥æ­£å¸¸å¯åŠ¨  
**é‚®ä»¶åŠŸèƒ½**: éœ€è¦çœŸå®é…ç½®åæ‰èƒ½ä½¿ç”¨  
**å…¶ä»–åŠŸèƒ½**: å®Œå…¨æ­£å¸¸

**ç°åœ¨è¯·åœ¨IDEAä¸­é‡æ–°å¯åŠ¨åº”ç”¨ï¼**ğŸš€
